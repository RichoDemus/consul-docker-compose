version: "2"

services:
  consul-master:
    image: progrium/consul
    command: -server -bootstrap-expect 2
    networks:
      - consul

  consul-quorum-member:
    image: progrium/consul
    command: -server -join consul-master
    depends_on:
      - consul-master
    networks:
      - consul

  consul-client:
    image: progrium/consul
    command: -join consul-quorum-member
    depends_on:
      - consul-quorum-member
    networks:
      - consul
    ports:
      - "8500:8500"

networks:
  consul:
    driver: bridge
